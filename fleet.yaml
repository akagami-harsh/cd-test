# Fleet bundle configuration
# This file tells Fleet how to deploy the contents of this repository
# Using pure Kustomize

defaultNamespace: gitops-test

# Target the local Rancher cluster
# cluster label info clusters.fleet.cattle.io
targetCustomizations:
  - name: local
    clusterSelector:
      matchLabels:
        name: local
    kustomize:
      dir: overlays/dev

# Default Kustomize options (fallback)
# kustomize:
#   dir: overlays/dev

# Ignore drift on labels managed by Helm/Fleet
diff:
  comparePatches:
    - apiVersion: apps/v1
      kind: Deployment
      jsonPointers:
        - /metadata/labels/app.kubernetes.io~1managed-by
        - /spec/template/metadata/labels/app.kubernetes.io~1managed-by
    - apiVersion: v1
      kind: ConfigMap
      jsonPointers:
        - /metadata/labels/app.kubernetes.io~1managed-by
    - apiVersion: v1
      kind: Service
      jsonPointers:
        - /metadata/labels/app.kubernetes.io~1managed-by
